[{
    "title": "Multiple SetResult on TaskCompletionSource",
    "date": "",
    "description": "An attempt was made to transition to a task to a final state when it had already completed error does not get picked up by visual studio test runner",
    "body": "Background Last week I was working on some end to end tests where we use an observable. This observable is using a TaskCompletionSource that we use to \u0026ldquo;close the subscription\u0026rdquo;. When we got the data we expected from the observable we would call SetResult on our TaskCompletionSource.\nTo prevent the observable from running forever, we used a CancelationTokenSource with a timeout. When the timeout occurs we made it call SetResult on our TaskCompletionSource.\nProblem This event occurs when the timer runs out, but our task was already completed. This means our code was trying to SetResult on an already completed task.\nWe are using Xunit and with Visual Studio or Rider. Neither of them would catches the error, the tests would somehow just stop running with no extra information, it was extremely strange.\nDiscovery Running dotnet test from the terminal actually failed the test with an \u0026ldquo;System.InvalidOperationException: An attempt was made to transition a task to a final state when it had already completed.\u0026rdquo;\nThe fix Simply replacing SetResult with TrySetResult solves the issue.\nI\u0026rsquo;ve included a sample Gist of the problem and the fix.\n",
    "ref": "/posts/complete-task-twice/"
  },{
    "title": "Present live camera feed in PowerPoint slides over Teams or Zoom",
    "date": "",
    "description": "Create amazing presentations where you can put yourself inside the presentation great for remote first jobs",
    "body": "STREAM Camera in PowerPoint Necessary software to install  OBS Obs websocket server PowerPoint OBS scene switcher  OBS Install OBS from here: Obs download link\nOBS websocket server For websocket server, you can find the file by scrolling all the way down, Install OBS websocket server plugin from here: Obs websocket server github releases.\nDownload the installer that matches your OS, or unzip the contents of the ZIP file into the folder where you installed OBS (C:\\OBSINSTALLPATH\\obsstudio). I recommend closing OBS before installing or unzipping the websocket server. Once installed, open OBS again, in the top menu click on Tools -\u0026gt; WebSockets Server Settings. It should look like this:\nEnable authentication and set a password you can remember and type later. We will need to input the password we set here in the PowerPoint OBS scene Switcher.\nWe need the webserver extension to change the OBS scenes when we change our PowerPoint slides.\nPowerPoint OBS Scene Switcher Clone or download the scene switcher code. I have included a built version of the program you can just run in the Compiled Executable folder. Otherwise you will need visual studio 2019 or newer to build and run the code.\nSetup Video resolution In the lower right side of the screen there is a Settings button, click it and it should show an option popup. Click on the Video tab in the popup window. Set Base (canvas) Resolution and Output (Scaled) Resolution to 1920x1080.\nI picked 1920x1080 as a resolution because it is the largest audience who has this screen format. It also scales well to 720p or 1440p screens. For all the other high end devices, they probably run on a higher resolution that can comfortably view the stream at 1080p.\nObs Scenes After you install OBS, by default it will have 3 scenes, I chose the first \u0026ldquo;Scene\u0026rdquo; as the \u0026ldquo;base scene\u0026rdquo; where I\u0026rsquo;ve added my microphone and camera as sources. We will use this scene with all of our slides, as it is simply the camera and microphone.\nAs you can see in the image below, I\u0026rsquo;ve added Scene and Display Capture, as input sources. We will need to do this for every slide where our green screen changes. Let\u0026rsquo;s being by creating a Scene and name it Slide 0. Under sources click the \u0026ldquo;+\u0026rdquo; button and select Scene as a source.\nNow we need to set a chroma filter for our display capture, this will allow the layer beneath the top layer, in this case our \u0026ldquo;Scene\u0026rdquo; layer will be shown in places where we have the right color green.\n Right click the \u0026ldquo;Display Capture\u0026rdquo; source. Click on Filters. In the popup settings window select the Chroma key effect filter, if it\u0026rsquo;s missing add it from the \u0026lsquo;+\u0026rsquo; sign under Effect Filters. Set the Key Color Type to Green and use a Similarity value of 360.  Now that we have our Scenes settings in order, make sure that both the scene and the Display Capture are full screen on the preview canvas. In my case I see the desktop of the display capture surrounded by a red square which is the base \u0026ldquo;Scene\u0026rdquo; that contains the camera and microphone input.\nWith these 2 layers, in order OBS will now make the color green of our display capture \u0026ldquo;transparent\u0026rdquo; so our 2nd layer can be seen through the green.\nPowerPoint Slides In our PowerPoint slides we simply put green wherever we want to appear, for example the images below are my first two slides. There is a slide from the left side animation on my name card to make it look more modern and integrated.\nAnother important sidenote, in PowerPoint remember to add OBS: \u0026ldquo;Your_scene_name\u0026rdquo; as the first text in the presenter notes. In the example above we have a Scene in OBS called Slide 0, so we write \u0026ldquo;OBS: Slide 0\u0026rdquo; in the presenter notes for slide 1. Sorry about the 0 instead of 1, computer people always start from 0.\nIf you don\u0026rsquo;t know about presenter notes, follow the image above.\n Click on the show presenter notes button in the bottom right. Write OBS: Scene_name on the first line.  The image above is the second slide where we write OBS: Slide 1, to match the second scene we have in OBS. The easiest way is to make an OBS scene from every slide, but you can also reuse them if the green screen location does not change.\n\r\rEND RESULT The image below is how it looks like on OBS in my \u0026ldquo;Slide 0\u0026rdquo; scene. As you can see the non green part of the screen is on top of my camera input, or in other words, everything that is screen becomes transparent on the \u0026ldquo;Display Capture\u0026rdquo; source so we can see the scene \u0026ldquo;Scene\u0026rdquo; which is the Camera and Sound Capture.\nCenter yourself to the side of the screen In this slide I want to place myself to the left side of the screen. To do this I made the PowerPoint slide with a large green block on the left side. I\u0026rsquo;ve also added \u0026ldquo;Slide 2\u0026rdquo; in the presenter comments of this PowerPoint slide. Now we need to setup \u0026ldquo;Slide 2\u0026rdquo; scene in OBS.\nAs usual we use the Display Capture Source and Scene source, if you look in the image above, I dragged the input scene nammed \u0026ldquo;Scene\u0026rdquo; with my mouse to the left. You can see the \u0026ldquo;Scene source\u0026rdquo; is moved to the left, so much left that the left part of it is out of the canvas and won\u0026rsquo;t be seen or rendered. However this allows us to be in the center of “Scene” while being on the left side of the Powerpoint screen.\nOBS PowerPoint scene switcher Once we have our PowerPoint slides prepared with the green screen and the correct text in the presenter notes we have to run the OBS PowerPoint scene switcher software.\nIf you haven\u0026rsquo;t already downloaded it, you can get it here: PowerPointObsSceneSwitcher.\nIf you want to modify and build the code yourself, you need Visual Studio 2019, otherwise just run the built code from the Compiled Executable folder.\nOnce you run it will ask you for a password. This is the password we previously set on the OBS PowerPoint scene switcher. If the password is correct, you can see it writes the OBS Scenes.\nTry to start presenting in PowerPoint and switch between the slides. If the program works you can see yourself in OBS and in the switcher you can see Moving to Slide Number X Switching to OBS Scene named \u0026ldquo;SceneName\u0026rdquo;.\nBig thank you to Jeff Fritz, Scott Hanselman and the community for this software.\nPresent in Microsoft Teams There are two ways to present our slides in Microsoft teams\n Virtual camera Share screen preview  Virtual camera In virtual camera mode, OBS preview becomes the camera stream. This is the easiest way to stream, but it might not succeed at grabbing the attention of your entire audience. In Microsoft Teams, before joining the meeting, make sure you select the OBS Virtual Camera like in the image below.\nIn OBS make sure you click on the Start Virtual Camera button in the bottom right of OBS. Now you should be able to see your OBS preview in Microsoft Teams.\nJoin the meeting and start your presentation, make sure to remember to right click your portrait and Spotlight yourself.\nScreen share This mode is great if you have 2 screens, it might be a tad more challenging to set up with only 1 screen. The image below displays how it should look if everything is set up correctly.\nStart presenter mode in PowerPoint, switch to OBS. In OBS right click on the preview window, select Fullscreen Projector (Preview) -\u0026gt; Select the monitor you wish to fullscreen to. I use a 1920x1080 monitor since it\u0026rsquo;s one of the most commonly encountered monitor resolution. This will create a fullscreen preview on the selected screen. You can Alt-Tab out of it and even minimize it.\nIn Microsoft teams, click on the Share content button, click on \u0026ldquo;Window\u0026rdquo;, and find the Full Screen Projector (Preview). Now you should be good to go, make sure to check with a friend that everything works before presenting to a larger audience.\nThis method has a minor downside, we have to stop the camera in obs or just exit obs after our presentation ends. We have to do this to free up the camera so Microsoft Teams can use it again.\n",
    "ref": "/posts/live-camera-feed-in-powerpoint-slides/"
  },{
    "title": "Hello World",
    "date": "",
    "description": "A brief intro about myself",
    "body": "Whom is this blog for? AWS with dotnet using C# This blog is the about the life of a full stack software engineer experienced with dotnet and Angular, currently working with dotnet on AWS infrastructure at one of the largest toy companies in the world.\n   Who am I? Software Engineer I studied software engineering since 2010 and have been working in the field since 2012 (student job). My first software engineering job on the SAP tech stack writing ABAP. I also got to touch a bit of web and javascript. After 3 years I moved to another department doing JVM with Java and some Groovy, then I moved again to .NET and Angular on Azure. Basically I went where opportunity took me, the technology was just a means to an end, I see technology as tool or means to an end, the point is to use technology to reach your/the company goal. It was great to see how different teams work and develop software. The culture in every team I worked in is very different based on the technology stack. If I had to pick favourites it\u0026rsquo;s definitely the culture in the .NET team, the java people I met were ridiculously religious against everything Microsoft.\nImmigrant \u0026amp; Dual citizen I was born in Romania but moved to Denmark right after high school for university. I ended settling in Denmark but it came at a great cost. I had to leave my parents and all my childhood friends behind. I jumped head first in a foreign land where there were no friends or family to support me. It was tough in the start but somehow I\u0026rsquo;ve managed to find a place for myself in this country. I met lots of amazing people and made some great friends along the way. After 11 years in Denmark, some bureaucracy and a culture test I can proudly call myself Danish and I got to keep the Romanian title too.\nHobby PC Gamer Since the pandemic started I picked up World of Warcraft again but I try to limit the amount of time I spend on it so I can try other games. More recently I\u0026rsquo;ve been enjoying Velheim and Risk of Rain 2 with my very good mates.\n Denmark in March   ",
    "ref": "/posts/my-first-post/"
  }]
